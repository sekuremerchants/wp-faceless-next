{"version":3,"file":"./chunks/ajax_forms.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAAA,MAAM,CAACC,iBAAiB,GAAG,YAAM;EAC/BC,CAAC,CAAC,eAAe,CAAC,CAACC,WAAW,CAAC,YAAY,CAAC;AAC9C,CAAC;AAEM,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAqBA,CAAIC,KAAK,EAAEC,IAAI,EAAEC,KAAK,EAAK;EAC3D;EACA;EACA,IAAMC,IAAI,GAAGC,IAAI,CAACC,SAAS,CAACL,KAAK,CAAC;EAClCH,CAAC,CAACS,IAAI,CAAC;IACLC,MAAM,EAAE,MAAM;IACdC,GAAG,EAAEC,KAAK,GAAG,2CAA2C;IACxDN,IAAI,EAAEA,IAAI;IACVO,QAAQ,EAAE;EACZ,CAAC,CAAC,CAACC,IAAI,CAAC,UAACR,IAAI,EAAK;IAChB,IAAI;MACF,IAAIA,IAAI,CAACS,MAAM,EAAE;QACf,IAAIC,QAAQ,CAACZ,IAAI,EAAEC,KAAK,CAAC;MAC3B,CAAC,MAAM;QACLD,IAAI,CAACH,WAAW,CAAC,cAAc,CAAC;MAClC;IACF,CAAC,CAAC,OAAOgB,CAAC,EAAE;MACVC,OAAO,CAACC,KAAK,CAACF,CAAC,CAAC;IAClB;EACF,CAAC,CAAC;AACJ,CAAC;AAEM,IAAMD,QAAQ;EACnB,SAAAA,SAAYZ,IAAI,EAAEC,KAAK,EAAE;IAAAe,eAAA,OAAAJ,QAAA;IACvB,IAAI,CAACZ,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,KAAK,GAAGA,KAAK;IAClB,IAAI,CAACgB,UAAU,CAAC,CAAC;EACnB;EAAC,OAAAC,YAAA,CAAAN,QAAA;IAAAO,GAAA;IAAAC,KAAA,EAED,SAAAH,UAAUA,CAAA,EAAG;MAAA,IAAAI,KAAA;MACX,IAAMd,GAAG,GAAG,IAAI,CAACP,IAAI,CAACE,IAAI,CAAC,QAAQ,CAAC;MACpC,IAAMI,MAAM,GAAG,IAAI,CAACN,IAAI,CAACE,IAAI,CAAC,QAAQ,CAAC;MACvC,IAAMA,IAAI,GAAG,IAAI,CAACF,IAAI,CAACsB,SAAS,CAAC,CAAC;MAClC1B,CAAC,CAACS,IAAI,CAAC;QACLC,MAAM,EAAEA,MAAM;QACdC,GAAG,EAAEA,GAAG;QACRL,IAAI,EAAEA,IAAI;QACVO,QAAQ,EAAE;MACZ,CAAC,CAAC,CACCC,IAAI,CAAC,UAACR,IAAI,EAAK;QACd,IAAI;UACF;UACA,IAAIA,IAAI,CAACS,MAAM,EAAE;YACf,IAAIY,eAAe,CAACF,KAAI,CAACrB,IAAI,EAAE,IAAI,EAAEE,IAAI,CAACsB,OAAO,CAAC,CAACC,WAAW,CAAC,CAAC;YAChEC,UAAU,CAAC,YAAM;cACfL,KAAI,CAACrB,IAAI,CAACH,WAAW,CAAC,cAAc,CAAC;cACrC,IAAI0B,eAAe,CAACF,KAAI,CAACrB,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC2B,WAAW,CAAC,CAAC;cACxD/B,CAAC,CAAC,cAAc,CAAC,CAACgC,MAAM,GACpBhC,CAAC,CAAC,cAAc,CAAC,CAACC,WAAW,CAAC,aAAa,CAAC,GAC5C,IAAI;cACR,IAAIK,IAAI,CAAC2B,QAAQ,IAAI3B,IAAI,CAAC2B,QAAQ,CAACD,MAAM,EAAE;gBACzClC,MAAM,CAACoC,QAAQ,GAAG5B,IAAI,CAAC2B,QAAQ;cACjC;YACF,CAAC,EAAE,IAAI,CAAC;UACV,CAAC,MAAM;YACL,IAAIN,eAAe,CAACF,KAAI,CAACrB,IAAI,EAAEE,IAAI,CAAC6B,MAAM,EAAE,IAAI,CAAC,CAACC,SAAS,CAAC,CAAC;YAC7DX,KAAI,CAACrB,IAAI,CAACH,WAAW,CAAC,cAAc,CAAC;YACrC;UACF;QACF,CAAC,CAAC,OAAOgB,CAAC,EAAE;UACVC,OAAO,CAACC,KAAK,CAACF,CAAC,CAAC;QAClB;MACF,CAAC,CAAC,CACDoB,MAAM,CAAC,UAAC/B,IAAI,EAAK;QAChBwB,UAAU,CAAC,YAAM,CAAC,CAAC,EAAE,GAAG,CAAC;;QAEzB;MACF,CAAC,CAAC;IACN;EAAC;AAAA;AAGI,IAAMH,eAAe;EAC1B,SAAAA,gBAAYvB,IAAI,EAAE+B,MAAM,EAAEP,OAAO,EAAE;IAAAR,eAAA,OAAAO,eAAA;IACjC,IAAI,CAACvB,IAAI,GAAGA,IAAI;IAChB,IAAI,CAAC+B,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACP,OAAO,GAAGA,OAAO;EACxB;EAAC,OAAAN,YAAA,CAAAK,eAAA;IAAAJ,GAAA;IAAAC,KAAA,EACD,SAAAO,WAAWA,CAAA,EAAG;MACZ,IAAI;QACF/B,CAAC,CAAC,cAAc,CAAC,CAACC,WAAW,CAAC,aAAa,CAAC;QAC5C,IAAI,CAACG,IAAI,CACNkC,IAAI,CAAC,6DAA6D,CAAC,CACnEC,GAAG,CAAC,EAAE,CAAC,CACPC,IAAI,CAAC,CAAC;QACT,IAAI,CAACpC,IAAI,CAACkC,IAAI,CAAC,wBAAwB,CAAC,CAACG,IAAI,CAAC,SAAS,EAAE,KAAK,CAAC;MACjE,CAAC,CAAC,OAAOxB,CAAC,EAAE;QACVC,OAAO,CAACwB,GAAG,CAACzB,CAAC,CAAC;MAChB;IACF;EAAC;IAAAM,GAAA;IAAAC,KAAA,EACD,SAAAY,SAASA,CAAA,EAAG;MAAA,IAAAO,MAAA;MACV3C,CAAC,CAAC4C,IAAI,CAAC,IAAI,CAACT,MAAM,EAAE,UAACZ,GAAG,EAAEsB,KAAK,EAAK;QAClC,IAAItB,GAAG,IAAI,aAAa,EAAE;UACxBoB,MAAI,CAACvC,IAAI,CACNkC,IAAI,KAAAQ,MAAA,CAAKvB,GAAG,CAAE,CAAC,CACfwB,MAAM,CAAC,CAAC,CACRC,QAAQ,CAAC,YAAY,CAAC,CACtBV,IAAI,CAAC,gBAAgB,CAAC,CACtBW,IAAI,CAACJ,KAAK,CAAC;QAChB,CAAC,MAAM;UACLF,MAAI,CAACvC,IAAI,CACNkC,IAAI,CAAC,SAAS,GAAGf,GAAG,GAAG,IAAI,CAAC,CAC5BwB,MAAM,CAAC,CAAC,CACRC,QAAQ,CAAC,YAAY,CAAC;UACzBL,MAAI,CAACvC,IAAI,CACNkC,IAAI,CAAC,SAAS,GAAGf,GAAG,GAAG,IAAI,CAAC,CAC5BgB,GAAG,CAAC,EAAE,CAAC,CACPQ,MAAM,CAAC,CAAC,CACRG,IAAI,CAAC,gBAAgB,EAAEP,MAAI,CAACR,MAAM,CAACZ,GAAG,CAAC,CAAC,CACxCtB,WAAW,CAAC,aAAa,CAAC;QAC/B;MACF,CAAC,CAAC;IACJ;EAAC;IAAAsB,GAAA;IAAAC,KAAA,EACD,SAAAK,WAAWA,CAAA,EAAG;MAAA,IAAAsB,MAAA;MACZ,IAAI,CAAC/C,IAAI,CACNkC,IAAI,CAAC,mBAAmB,CAAC,CACzBW,IAAI,CAAC,IAAI,CAACrB,OAAO,CAAC,CAClBoB,QAAQ,CAAC,cAAc,CAAC;MAC3BlB,UAAU,CAAC,YAAM;QACfqB,MAAI,CAAC/C,IAAI,CAACkC,IAAI,CAAC,mBAAmB,CAAC,CAACrC,WAAW,CAAC,cAAc,CAAC;MACjE,CAAC,EAAE,IAAI,CAAC;IACV;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;EAAA;AAAA;AAGK,IAAMmD,IAAI,GAAG,SAAPA,IAAIA,CAAA,EAAS;EACxBpD,CAAC,CAAC,mCAAmC,CAAC,CAACqD,EAAE,CAAC,QAAQ,EAAE,UAACpC,CAAC,EAAK;IACzDA,CAAC,CAACqC,cAAc,CAAC,CAAC;IAClBtD,CAAC,CAACiB,CAAC,CAACsC,aAAa,CAAC,CAACjB,IAAI,CAAC,aAAa,CAAC,CAACrC,WAAW,CAAC,YAAY,CAAC;IAChED,CAAC,CAACiB,CAAC,CAACsC,aAAa,CAAC,CAACjB,IAAI,CAAC,kBAAkB,CAAC,CAACrC,WAAW,CAAC,iBAAiB,CAAC;IAC1E,IAAID,CAAC,CAACiB,CAAC,CAACsC,aAAa,CAAC,CAACC,QAAQ,CAAC,cAAc,CAAC,EAAE;IACjDxD,CAAC,CAACiB,CAAC,CAACsC,aAAa,CAAC,CAACP,QAAQ,CAAC,cAAc,CAAC;IAC3C,IAAIhC,QAAQ,CAAChB,CAAC,CAACiB,CAAC,CAACsC,aAAa,CAAC,EAAEtC,CAAC,CAAC;EACrC,CAAC,CAAC;EAEFjB,CAAC,CAAC,mBAAmB,CAAC,CAACqD,EAAE,CAAC,QAAQ,EAAE,UAACpC,CAAC,EAAK;IACzCA,CAAC,CAACqC,cAAc,CAAC,CAAC;IAClBtD,CAAC,CAACiB,CAAC,CAACsC,aAAa,CAAC,CAACjB,IAAI,CAAC,aAAa,CAAC,CAACrC,WAAW,CAAC,YAAY,CAAC;IAChED,CAAC,CAACiB,CAAC,CAACsC,aAAa,CAAC,CAACjB,IAAI,CAAC,kBAAkB,CAAC,CAACrC,WAAW,CAAC,iBAAiB,CAAC;IAC1E,IACE,OAAOwD,UAAU,KAAK,WAAW,IACjCzD,CAAC,CAACiB,CAAC,CAACsC,aAAa,CAAC,CAACC,QAAQ,CAAC,cAAc,CAAC,EAE3C;IACFxD,CAAC,CAACiB,CAAC,CAACsC,aAAa,CAAC,CAACP,QAAQ,CAAC,cAAc,CAAC;IAC3CS,UAAU,CAACC,KAAK,CAAC,YAAY;MAC3BD,UAAU,CACPE,OAAO,CAACC,aAAa,EAAE;QACtBC,MAAM,EAAE7D,CAAC,CAACiB,CAAC,CAACsC,aAAa,CAAC,CAACjD,IAAI,CAAC,kBAAkB;MACpD,CAAC,CAAC,CACDwD,IAAI,CAAC,UAAC3D,KAAK,EAAK;QACfD,qBAAqB,CAACC,KAAK,EAAEH,CAAC,CAACiB,CAAC,CAACsC,aAAa,CAAC,EAAEtC,CAAC,CAAC;MACrD,CAAC,CAAC;IACN,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC","sources":["webpack://sekure-website/./assets/js/src/theme/utils/ajaxForms.js"],"sourcesContent":["window.recaptchaCallback = () => {\r\n  $('.captcha-hold').removeClass('form-error');\r\n};\r\n\r\nexport const onRecaptchaFormSubmit = (token, form, event) => {\r\n  // console.log(token, 'token');\r\n  // console.log(form, 'form');\r\n  const data = JSON.stringify(token);\r\n  $.ajax({\r\n    method: 'POST',\r\n    url: _root + 'js/theme/requests/g-recaptcha-verify.json',\r\n    data: data,\r\n    dataType: 'JSON',\r\n  }).done((data) => {\r\n    try {\r\n      if (data.status) {\r\n        new AjaxForm(form, event);\r\n      } else {\r\n        form.removeClass('form-loading');\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  });\r\n};\r\n\r\nexport class AjaxForm {\r\n  constructor(form, event) {\r\n    this.form = form;\r\n    this.event = event;\r\n    this.submitForm();\r\n  }\r\n\r\n  submitForm() {\r\n    const url = this.form.data('action');\r\n    const method = this.form.data('method');\r\n    const data = this.form.serialize();\r\n    $.ajax({\r\n      method: method,\r\n      url: url,\r\n      data: data,\r\n      dataType: 'JSON',\r\n    })\r\n      .done((data) => {\r\n        try {\r\n          // console.log(data.status)\r\n          if (data.status) {\r\n            new AjaxFormActions(this.form, null, data.success).showSuccess();\r\n            setTimeout(() => {\r\n              this.form.removeClass('form-loading');\r\n              new AjaxFormActions(this.form, null, null).clearFields();\r\n              $('.user-typing').length\r\n                ? $('.user-typing').removeClass('user-typing')\r\n                : null;\r\n              if (data.redirect && data.redirect.length) {\r\n                window.location = data.redirect;\r\n              }\r\n            }, 1000);\r\n          } else {\r\n            new AjaxFormActions(this.form, data.errors, null).addErrors();\r\n            this.form.removeClass('form-loading');\r\n            // new AjaxFormActions(this.form, null, null).removeErrorsOnFocus()\r\n          }\r\n        } catch (e) {\r\n          console.error(e);\r\n        }\r\n      })\r\n      .always((data) => {\r\n        setTimeout(() => {}, 500);\r\n\r\n        // $('.g-recaptcha').length ? grecaptcha.reset() : null\r\n      });\r\n  }\r\n}\r\n\r\nexport class AjaxFormActions {\r\n  constructor(form, errors, success) {\r\n    this.form = form;\r\n    this.errors = errors;\r\n    this.success = success;\r\n  }\r\n  clearFields() {\r\n    try {\r\n      $('.user-typing').removeClass('user-typing');\r\n      this.form\r\n        .find('input:not([type=\"hidden\"]):not([type=\"checkbox\"]), textarea')\r\n        .val('')\r\n        .blur();\r\n      this.form.find('input[type=\"checkbox\"]').prop('checked', false);\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n  addErrors() {\r\n    $.each(this.errors, (key, field) => {\r\n      if (key == 'g-recaptcha') {\r\n        this.form\r\n          .find(`.${key}`)\r\n          .parent()\r\n          .addClass('form-error')\r\n          .find('.captcha-error')\r\n          .html(field);\r\n      } else {\r\n        this.form\r\n          .find(\"[name='\" + key + \"']\")\r\n          .parent()\r\n          .addClass('form-error');\r\n        this.form\r\n          .find(\"[name='\" + key + \"']\")\r\n          .val('')\r\n          .parent()\r\n          .attr('data-error-txt', this.errors[key])\r\n          .removeClass('user-typing');\r\n      }\r\n    });\r\n  }\r\n  showSuccess() {\r\n    this.form\r\n      .find('.form-success-msg')\r\n      .html(this.success)\r\n      .addClass('show-success');\r\n    setTimeout(() => {\r\n      this.form.find('.form-success-msg').removeClass('show-success');\r\n    }, 5000);\r\n  }\r\n  // removeErrorsOnFocus() {\r\n  //     try {\r\n  //         this.form.on('change focus keydown paste input', 'input, textarea', e =>\r\n  //             $(e.currentTarget).parents('.form-error').removeClass('form-error')\r\n  //         )\r\n  //     }\r\n  //     catch (e) {\r\n  //         console.log(e)\r\n  //     }\r\n  // }\r\n}\r\n\r\nexport const init = () => {\r\n  $('.ajax-form:not(.g-recaptcha-form)').on('submit', (e) => {\r\n    e.preventDefault();\r\n    $(e.currentTarget).find('.form-error').removeClass('form-error');\r\n    $(e.currentTarget).find('.show-file-error').removeClass('show-file-error');\r\n    if ($(e.currentTarget).hasClass('form-loading')) return;\r\n    $(e.currentTarget).addClass('form-loading');\r\n    new AjaxForm($(e.currentTarget), e);\r\n  });\r\n\r\n  $('.g-recaptcha-form').on('submit', (e) => {\r\n    e.preventDefault();\r\n    $(e.currentTarget).find('.form-error').removeClass('form-error');\r\n    $(e.currentTarget).find('.show-file-error').removeClass('show-file-error');\r\n    if (\r\n      typeof grecaptcha === 'undefined' ||\r\n      $(e.currentTarget).hasClass('form-loading')\r\n    )\r\n      return;\r\n    $(e.currentTarget).addClass('form-loading');\r\n    grecaptcha.ready(function () {\r\n      grecaptcha\r\n        .execute(_googleAPIKey, {\r\n          action: $(e.currentTarget).data('recaptcha-action'),\r\n        })\r\n        .then((token) => {\r\n          onRecaptchaFormSubmit(token, $(e.currentTarget), e);\r\n        });\r\n    });\r\n  });\r\n};\r\n"],"names":["window","recaptchaCallback","$","removeClass","onRecaptchaFormSubmit","token","form","event","data","JSON","stringify","ajax","method","url","_root","dataType","done","status","AjaxForm","e","console","error","_classCallCheck","submitForm","_createClass","key","value","_this","serialize","AjaxFormActions","success","showSuccess","setTimeout","clearFields","length","redirect","location","errors","addErrors","always","find","val","blur","prop","log","_this2","each","field","concat","parent","addClass","html","attr","_this3","init","on","preventDefault","currentTarget","hasClass","grecaptcha","ready","execute","_googleAPIKey","action","then"],"sourceRoot":""}